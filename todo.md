# Firewall Manager - –ü–æ–ª–Ω—ã–π –ü–ª–∞–Ω –ü—Ä–æ–µ–∫—Ç–∞

> **–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 23 –æ–∫—Ç—è–±—Ä—è 2025 –≥.  
> **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Python + Rust + React + PostgreSQL + TimescaleDB

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å–∏—Å—Ç–µ–º—ã)
- [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö](#–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö](#–ø–æ—Ç–æ–∫-–¥–∞–Ω–Ω—ã—Ö)
- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ-–¥–µ—Ç–∞–ª–∏)
- [–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è](#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è)
- [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)
- [–ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏](#–ø–ª–∞–Ω-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- [Roadmap](#roadmap)

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –û–±—â–∞—è —Å—Ö–µ–º–∞

```text
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           Frontend (React + TS)                 ‚îÇ
‚îÇ  - Dashboard, Rules, Logs, Users, Analytics     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚îÇ REST API / WebSocket
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Python Backend (FastAPI)                ‚îÇ
‚îÇ  - API endpoints                                ‚îÇ
‚îÇ  - –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞                                ‚îÇ
‚îÇ  - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è/–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è                   ‚îÇ
‚îÇ  - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞–º–∏                         ‚îÇ
‚îÇ  - ORM (SQLAlchemy)                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ                          ‚îÇ
       ‚îÇ Python bindings          ‚îÇ Direct DB Write
       ‚ñº                          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Rust Core       ‚îÇ    ‚îÇ  Rust Traffic Monitor  ‚îÇ
‚îÇ  - nftables API  ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚î§  - Packet capture      ‚îÇ
‚îÇ  - ipset         ‚îÇ    ‚îÇ  - Deep inspection     ‚îÇ
‚îÇ  - Firewall ops  ‚îÇ    ‚îÇ  - Pattern detection   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ  - Metrics collection  ‚îÇ
                        ‚îÇ  - –ê–≤—Ç–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞      ‚îÇ
                        ‚îÇ  - Batch DB inserts    ‚îÇ
                        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                    ‚îÇ
                        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                        ‚îÇ   PostgreSQL 15+       ‚îÇ
                        ‚îÇ   + TimescaleDB 2.x    ‚îÇ
                        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### PostgreSQL + TimescaleDB

#### 1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

**users** - —É—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏

- –ü–æ–ª—è: `id`, `username`, `email`, `password_hash`, `role`, `is_approved`, `is_active`, `created_at`, `last_login`
- –†–æ–ª–∏: `root`, `admin`, `operator`, `viewer`
- –ò–Ω–¥–µ–∫—Å—ã: `username`, `email`

**sessions** - –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏

- –ü–æ–ª—è: `id`, `user_id`, `token_hash`, `ip_address`, `user_agent`, `expires_at`, `is_active`
- –î–ª—è invalidation JWT —Ç–æ–∫–µ–Ω–æ–≤
- –ò–Ω–¥–µ–∫—Å—ã: `user_id`, `token_hash`, `expires_at`

#### 2. Firewall –ø—Ä–∞–≤–∏–ª–∞

**firewall_rules** - –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞

- –ü–æ–ª—è: `id`, `name`, `description`, `action` (accept/drop/reject), `priority`
- Source: `source_ip` (CIDR), `source_country`, `source_port`
- Destination: `dest_ip`, `dest_port`
- Protocol: tcp/udp/icmp/any
- Metadata: `is_enabled`, `is_system`, `log_enabled`, `rate_limit`
- Tracking: `created_by`, `created_at`, `updated_at`, `applied_at`
- Statistics: `match_count`, `last_match_at`
- –ò–Ω–¥–µ–∫—Å—ã: `is_enabled`, `priority`, `source_ip` (GIST)

#### 3. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏

**blocked_ips** - –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–¥—Ä–µ—Å–∞

- –ü–æ–ª—è: `id`, `ip_address`, `reason`, `block_type` (temporary/permanent)
- Auto-block: `trigger_rule_id`, `violation_count`
- Timing: `blocked_at`, `expires_at`, `unblocked_at`
- Metadata: `blocked_by`, `country_code`, `asn`, `notes`, `is_active`
- –ò–Ω–¥–µ–∫—Å—ã: `ip_address`, `is_active+expires_at`

#### 4. –õ–æ–≥–∏ –∏ –º–µ—Ç—Ä–∏–∫–∏ (TimescaleDB hypertables)

**firewall_logs** - –≤—Å–µ —Å–æ–±—ã—Ç–∏—è (hypertable –ø–æ time)

- –ü–æ–ª—è: `time`, `source_ip`, `source_port`, `dest_ip`, `dest_port`, `protocol`
- Action: `action`, `rule_id`, `rule_name`
- Packet: `packet_size`, `ttl`, `flags`
- Metadata: `country_code`, `asn`, `threat_level`, `extra_data` (JSONB)
- Retention policy: 30 –¥–Ω–µ–π
- –ò–Ω–¥–µ–∫—Å—ã: `time`, `source_ip+time`, `action+time`, `rule_id+time`
- Continuous aggregates: –ø–æ –º–∏–Ω—É—Ç–∞–º, —á–∞—Å–∞–º, –¥–Ω—è–º

**traffic_metrics** - –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (hypertable)

- Traffic: `packets_in/out`, `bytes_in/out`
- Connections: `connections_active`, `connections_new`, `connections_closed`
- Firewall: `packets_dropped`, `packets_accepted`, `packets_rejected`
- System: `cpu_usage`, `memory_usage`
- Additional: `metrics_data` (JSONB)
- Retention: 7 –¥–Ω–µ–π raw, 90 –¥–Ω–µ–π –∞–≥—Ä–µ–≥–∞—Ç—ã
- Continuous aggregates: 1min, 5min, 1hour

**top_talkers** - —Å–∞–º—ã–µ –∞–∫—Ç–∏–≤–Ω—ã–µ IP (hypertable)

- –ü–æ–ª—è: `time`, `ip_address`, `packets`, `bytes`, `connections`
- Metadata: `country_code`, `asn`, `is_suspicious`
- Retention: 24 —á–∞—Å–∞
- –î–ª—è dashboard –≤–∏–¥–∂–µ—Ç–æ–≤

#### 5. –ê—É–¥–∏—Ç –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**audit_log** - –∏—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π

- –ü–æ–ª—è: `id`, `time`, `user_id`, `username`, `action`, `resource_type`, `resource_id`
- Request: `ip_address`, `user_agent`
- Changes: `old_value` (JSONB), `new_value` (JSONB)
- Result: `success`, `error_message`
- –ò–Ω–¥–µ–∫—Å—ã: `time`, `user_id+time`, `action+time`

**system_settings** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

- –ü–æ–ª—è: `key`, `value` (JSONB), `description`, `updated_by`, `updated_at`
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏: `brute_force_threshold`, `port_scan_threshold`, `auto_unblock`, retention policies

**backup_history** - –∏—Å—Ç–æ—Ä–∏—è backup'–æ–≤

- –ü–æ–ª—è: `id`, `backup_type`, `file_path`, `file_size`, `created_by`, `created_at`, `notes`

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
firewall-manager/
‚îÇ
‚îú‚îÄ‚îÄ rust-core/                           # Rust –º–æ–¥—É–ª–∏ (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
‚îÇ   ‚îú‚îÄ‚îÄ Cargo.toml
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lib.rs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ nftables/                    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ nftables
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rules.rs                 # CRUD –ø—Ä–∞–≤–∏–ª
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tables.rs                # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü–∞–º–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ chains.rs                # –¶–µ–ø–æ—á–∫–∏ –ø—Ä–∞–≤–∏–ª
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sets.rs                  # ipset —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ traffic/                     # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ capture.rs               # –ó–∞—Ö–≤–∞—Ç –ø–∞–∫–µ—Ç–æ–≤ (libpcap/AF_PACKET)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ analyzer.rs              # –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ parser.rs                # –ü–∞—Ä—Å–∏–Ω–≥ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ metrics.rs               # –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –≤ –ø–∞–º—è—Ç–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ autoblock/                   # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bruteforce.rs            # SSH/auth brute-force
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ portscan.rs              # Port scan detection
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ddos.rs                  # DDoS mitigation (–æ–ø—Ü.)
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ patterns.rs              # Pattern matching engine
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database/                    # Direct DB access (tokio-postgres)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pool.rs                  # Connection pool (deadpool)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logs.rs                  # Batch insert –ª–æ–≥–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ metrics.rs               # Batch insert –º–µ—Ç—Ä–∏–∫
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ blocked.rs               # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ blocked_ips
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ queries.rs               # Prepared statements
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ geoip/                       # GeoIP lookup (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ maxmind.rs               # MaxMind DB reader
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ bindings/                    # Python bindings (PyO3)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ firewall.rs              # Firewall operations
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ monitor.rs               # Metrics/monitoring
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ config.rs                # Configuration
‚îÇ   ‚îî‚îÄ‚îÄ benches/                         # Performance benchmarks
‚îÇ
‚îú‚îÄ‚îÄ backend/                             # Python Backend (FastAPI)
‚îÇ   ‚îú‚îÄ‚îÄ pyproject.toml
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îú‚îÄ‚îÄ alembic/                         # DB –º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ versions/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 001_initial_schema.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 002_add_timescaledb.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ 003_audit_log.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ env.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ alembic.ini
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.py                      # FastAPI application
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py                  # SQLAlchemy setup + session
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py                    # Settings (pydantic BaseSettings)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/                         # API routes
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py                  # Login, register, logout, refresh
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users.py                 # CRUD users, approve/reject
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rules.py                 # CRUD firewall rules
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ blocked.py               # Blocked IPs management
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logs.py                  # Search/filter logs, export
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ metrics.py               # Aggregated metrics, charts data
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ analytics.py             # Advanced analytics queries
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ monitor.py               # WebSocket real-time metrics
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ audit.py                 # Audit log viewing
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ settings.py              # System settings
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ backup.py                # Backup/restore endpoints
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ core/                        # Business logic
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ firewall.py              # Wrapper –Ω–∞–¥ Rust core
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py                  # JWT, password hashing, permissions
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security.py              # RBAC, decorators
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ notifications.py         # Email/webhook alerts (–æ–ø—Ü.)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/                      # SQLAlchemy ORM models
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py                  # Base model
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py                  # User, Session models
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rule.py                  # FirewallRule model
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ blocked_ip.py            # BlockedIP model
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ log.py                   # FirewallLog model (hypertable)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ metric.py                # TrafficMetric, TopTalker models
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ audit.py                 # AuditLog model
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ setting.py               # SystemSetting model
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ backup.py                # BackupHistory model
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schemas/                     # Pydantic schemas (validation)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py                  # UserCreate, UserUpdate, UserResponse
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py                  # Login, Token, Register
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rule.py                  # RuleCreate, RuleUpdate, RuleResponse
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ blocked_ip.py            # BlockedIPCreate, BlockedIPResponse
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ log.py                   # LogSearch, LogResponse, LogExport
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ metric.py                # MetricResponse, ChartData
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ monitor.py               # RealtimeMetrics (WebSocket)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ crud/                        # Database operations
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py                  # Base CRUD class
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py                  # User CRUD operations
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rule.py                  # Rule CRUD operations
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ blocked_ip.py            # BlockedIP operations
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ log.py                   # Complex log queries, aggregations
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ metric.py                # Metric queries, time-series
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ analytics.py             # Advanced analytics queries
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ audit.py                 # Audit log queries
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ backup.py                # Backup/restore logic
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ query_builder.py         # SQL query helpers
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ validators.py            # Custom validators (IP, CIDR)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ formatters.py            # Data formatting (bytes, dates)
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ export.py                # CSV/JSON export utilities
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ workers/                     # Background tasks (–æ–ø—Ü.)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ cleanup.py               # Expired blocks cleanup
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ aggregation.py           # Periodic aggregations
‚îÇ   ‚îú‚îÄ‚îÄ tests/                           # Unit tests
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_api/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_crud/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test_core/
‚îÇ   ‚îî‚îÄ‚îÄ cli.py                           # CLI tool (Typer)
‚îÇ
‚îú‚îÄ‚îÄ frontend/                            # React Frontend
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.json
‚îÇ   ‚îú‚îÄ‚îÄ vite.config.ts
‚îÇ   ‚îú‚îÄ‚îÄ tailwind.config.js
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ vite-env.d.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/                       # –°—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Login.tsx                # –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dashboard.tsx            # –ì–ª–∞–≤–Ω–∞—è: –≥—Ä–∞—Ñ–∏–∫–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Rules.tsx                # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞–º–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BlockedIPs.tsx           # –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ IP
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Logs.tsx                 # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ —Å –ø–æ–∏—Å–∫–æ–º
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Analytics.tsx            # –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Users.tsx                # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (Root)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Audit.tsx                # Audit log (Admin+)
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Settings.tsx             # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/                  # –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/                      # shadcn/ui –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Layout.tsx               # –û—Å–Ω–æ–≤–Ω–æ–π layout —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Navbar.tsx               # Top navbar
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Sidebar.tsx              # Side menu
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProtectedRoute.tsx       # Route guard
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RuleForm.tsx             # –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RuleTable.tsx            # –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–∞–≤–∏–ª
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RuleCard.tsx             # –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–∞–≤–∏–ª–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LogTable.tsx             # –¢–∞–±–ª–∏—Ü–∞ –ª–æ–≥–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LogSearch.tsx            # –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –ª–æ–≥–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LogFilters.tsx           # Quick filters (last hour, 24h)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MetricsCard.tsx          # –ö–∞—Ä—Ç–æ—á–∫–∞ –º–µ—Ç—Ä–∏–∫–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MetricsChart.tsx         # –ì—Ä–∞—Ñ–∏–∫ –º–µ—Ç—Ä–∏–∫ (Recharts)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TrafficChart.tsx         # –ì—Ä–∞—Ñ–∏–∫ —Ç—Ä–∞—Ñ–∏–∫–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RealtimeMetrics.tsx      # Real-time –≤–∏–¥–∂–µ—Ç
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TopTalkers.tsx           # Top IP addresses widget
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CountryMap.tsx           # Geo-distribution (–æ–ø—Ü.)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BlockedIPTable.tsx       # –¢–∞–±–ª–∏—Ü–∞ blocked IPs
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BlockIPDialog.tsx        # –î–∏–∞–ª–æ–≥ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UserTable.tsx            # –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UserApproval.tsx         # Pending approvals
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ExportButton.tsx         # –ö–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/                         # API –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ client.ts                # Axios instance —Å interceptors
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ websocket.ts             # WebSocket manager
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.ts                  # Auth API calls
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rules.ts                 # Rules API calls
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logs.ts                  # Logs API calls
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ metrics.ts               # Metrics API calls
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ users.ts                 # Users API calls
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/                       # Custom React hooks
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAuth.ts               # Authentication state
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useRules.ts              # Rules management
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useLogs.ts               # Log queries
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useMetrics.ts            # Metrics queries
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useWebSocket.ts          # WebSocket connection
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useDebounce.ts           # Debounce helper
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ usePagination.ts         # Pagination helper
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ store/                       # State management (Zustand)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ authStore.ts             # Auth state
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rulesStore.ts            # Rules cache
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ settingsStore.ts         # UI settings (theme, lang)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types/                       # TypeScript types
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.ts                   # API response types
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.ts                # Domain models
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ enums.ts                 # Enums (Action, Role, etc)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/                       # Utility functions
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ formatters.ts            # Date, bytes, number formatting
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ validators.ts            # Form validators
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ constants.ts             # Constants
‚îÇ   ‚îî‚îÄ‚îÄ public/
‚îÇ       ‚îú‚îÄ‚îÄ favicon.ico
‚îÇ       ‚îî‚îÄ‚îÄ logo.svg
‚îÇ
‚îú‚îÄ‚îÄ database/                            # Database setup
‚îÇ   ‚îú‚îÄ‚îÄ init.sql                         # Initial schema (PostgreSQL)
‚îÇ   ‚îú‚îÄ‚îÄ timescaledb.sql                  # TimescaleDB setup
‚îÇ   ‚îú‚îÄ‚îÄ indexes.sql                      # Index creation
‚îÇ   ‚îú‚îÄ‚îÄ functions.sql                    # Stored procedures (–æ–ø—Ü.)
‚îÇ   ‚îú‚îÄ‚îÄ seeds.sql                        # Test data (dev only)
‚îÇ   ‚îî‚îÄ‚îÄ README.md                        # DB documentation
‚îÇ
‚îú‚îÄ‚îÄ scripts/                             # Installation scripts
‚îÇ   ‚îú‚îÄ‚îÄ install.sh                       # Main installer
‚îÇ   ‚îú‚îÄ‚îÄ uninstall.sh                     # Clean removal
‚îÇ   ‚îú‚îÄ‚îÄ setup-db.sh                      # PostgreSQL + TimescaleDB setup
‚îÇ   ‚îú‚îÄ‚îÄ build-rust.sh                    # Rust compilation script
‚îÇ   ‚îú‚îÄ‚îÄ build-frontend.sh                # Frontend build script
‚îÇ   ‚îú‚îÄ‚îÄ update.sh                        # Update existing installation
‚îÇ   ‚îî‚îÄ‚îÄ backup.sh                        # Backup script
‚îÇ
‚îú‚îÄ‚îÄ config/                              # Configuration templates
‚îÇ   ‚îú‚îÄ‚îÄ config.example.yaml              # Main config template
‚îÇ   ‚îú‚îÄ‚îÄ database.yaml                    # DB connection config
‚îÇ   ‚îú‚îÄ‚îÄ systemd/                         # Systemd service files
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ firewall-backend.service     # Python FastAPI service
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ firewall-monitor.service     # Rust traffic monitor
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ postgresql.service           # PostgreSQL (if bundled)
‚îÇ   ‚îú‚îÄ‚îÄ nginx/                           # Nginx configuration
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ firewall-manager.conf        # Main site config
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ssl.conf                     # SSL settings
‚îÇ   ‚îî‚îÄ‚îÄ logrotate/
‚îÇ       ‚îî‚îÄ‚îÄ firewall-manager             # Log rotation config
‚îÇ
‚îú‚îÄ‚îÄ docs/                                # Documentation
‚îÇ   ‚îú‚îÄ‚îÄ README.md
‚îÇ   ‚îú‚îÄ‚îÄ INSTALL.md                       # Installation guide
‚îÇ   ‚îú‚îÄ‚îÄ API.md                           # API documentation
‚îÇ   ‚îú‚îÄ‚îÄ DATABASE.md                      # Database schema
‚îÇ   ‚îú‚îÄ‚îÄ DEPLOYMENT.md                    # Deployment guide
‚îÇ   ‚îú‚îÄ‚îÄ DEVELOPMENT.md                   # Development setup
‚îÇ   ‚îî‚îÄ‚îÄ TROUBLESHOOTING.md               # Common issues
‚îÇ
‚îú‚îÄ‚îÄ docker/                              # Docker setup (–¥–ª—è dev)
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile.rust
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile.python
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile.postgres
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml
‚îÇ   ‚îî‚îÄ‚îÄ docker-compose.dev.yml
‚îÇ
‚îú‚îÄ‚îÄ .github/                             # CI/CD (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îú‚îÄ‚îÄ test.yml
‚îÇ       ‚îî‚îÄ‚îÄ build.yml
‚îÇ
‚îú‚îÄ‚îÄ README.md                            # Main readme
‚îú‚îÄ‚îÄ LICENSE
‚îî‚îÄ‚îÄ .gitignore
```

---

## –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

### 1. –ó–∞—Ö–≤–∞—Ç –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞

```text
–°–µ—Ç–µ–≤–æ–π –ø–∞–∫–µ—Ç
  ‚Üì
Rust Traffic Monitor (capture.rs)
  ‚Üì –ø–∞—Ä—Å–∏–Ω–≥ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
Rust Analyzer (analyzer.rs)
  ‚Üì –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª + pattern matching
Rust Autoblock (bruteforce.rs, portscan.rs)
  ‚Üì –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
Rust nftables (rules.rs) - –ø—Ä–∏–º–µ–Ω–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É
  ‚Üì
Rust Database (logs.rs) - batch insert –≤ firewall_logs
  ‚Üì
PostgreSQL (firewall_logs hypertable)
  ‚Üì –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ continuous aggregates
TimescaleDB –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ view
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ —á–µ—Ä–µ–∑ Web UI

```text
User –∑–∞–ø–æ–ª–Ω—è–µ—Ç RuleForm
  ‚Üì
React –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST /api/rules
  ‚Üì
Python FastAPI (api/rules.py)
  ‚Üì –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ Pydantic schema
  ‚Üì
Python CRUD (crud/rule.py) - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ DB
  ‚Üì
PostgreSQL (firewall_rules table)
  ‚Üì
Python Firewall Manager (core/firewall.py)
  ‚Üì –≤—ã–∑–æ–≤ Rust —á–µ—Ä–µ–∑ PyO3 bindings
Rust nftables (rules.rs) - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞
  ‚Üì –≤–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
Python –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON response
  ‚Üì
React –æ–±–Ω–æ–≤–ª—è–µ—Ç UI
```

### 3. Real-time –º–µ—Ç—Ä–∏–∫–∏ (WebSocket)

```text
Rust Traffic Monitor - —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
  ‚Üì
Rust Database (metrics.rs) - batch insert –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫
  ‚Üì
PostgreSQL (traffic_metrics hypertable)

–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ:
Rust –¥–µ—Ä–∂–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ –ø–∞–º—è—Ç–∏
  ‚Üì —á–µ—Ä–µ–∑ Python bindings
Python WebSocket endpoint (api/monitor.py)
  ‚Üì –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç
React WebSocket –∫–ª–∏–µ–Ω—Ç (useWebSocket hook)
  ‚Üì
Dashboard –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
```

### 4. –ü–æ–∏—Å–∫ –≤ –ª–æ–≥–∞—Ö

```text
User –≤–≤–æ–¥–∏—Ç —Ñ–∏–ª—å—Ç—Ä—ã –≤ LogSearch
  ‚Üì
React –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET /api/logs?source_ip=...&start_time=...
  ‚Üì
Python FastAPI (api/logs.py)
  ‚Üì
Python CRUD (crud/log.py) - –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ SQL –∑–∞–ø—Ä–æ—Å–∞
  ‚Üì –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω–¥–µ–∫—Å—ã (source_ip, time)
PostgreSQL (firewall_logs hypertable)
  ‚Üì –±—ã—Å—Ç—Ä–∞—è –≤—ã–±–æ—Ä–∫–∞ –±–ª–∞–≥–æ–¥–∞—Ä—è TimescaleDB
Python –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON (–ø–∞–≥–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
  ‚Üì
React LogTable –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
```

### 5. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ (–∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

```text
User –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Analytics —Å—Ç—Ä–∞–Ω–∏—Ü—É
  ‚Üì
React –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç GET /api/analytics/traffic-by-hour
  ‚Üì
Python FastAPI (api/analytics.py)
  ‚Üì
Python CRUD (crud/analytics.py)
  ‚Üì –∑–∞–ø—Ä–æ—Å –∫ continuous aggregate
SELECT * FROM traffic_metrics_1min WHERE bucket > ...
  ‚Üì
TimescaleDB –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  ‚Üì
Python —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
  ‚Üì
React Recharts –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç –≥—Ä–∞—Ñ–∏–∫–∏
```

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Rust: Performance-critical –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```toml
[dependencies]
# Async runtime
tokio = { version = "1.35", features = ["full"] }

# Database
tokio-postgres = "0.7"
deadpool-postgres = "0.12"

# Networking
pnet = "0.34"              # Packet capture
libc = "0.2"               # Low-level networking

# nftables
nftnl = "0.6"

# Serialization
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"

# Python bindings
pyo3 = { version = "0.20", features = ["extension-module"] }

# Utilities
chrono = "0.4"
ipnetwork = "0.20"
anyhow = "1.0"
thiserror = "1.0"

# GeoIP (optional)
maxminddb = "0.23"

# Logging
tracing = "0.1"
tracing-subscriber = "0.3"
```

#### –ö–ª—é—á–µ–≤—ã–µ –º–æ–¥—É–ª–∏

**1. Traffic Capture (–≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π)**

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç AF_PACKET (Linux) –∏–ª–∏ libpcap
- Zero-copy –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- Ring buffer –¥–ª—è –ø–∞–∫–µ—Ç–æ–≤
- Batch processing (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—á–∫–∞–º–∏)

**2. Pattern Matching Engine**

- State machine –¥–ª—è detection
- Sliding window –¥–ª—è rate limiting
- Bloom filters –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ IP
- LRU cache –¥–ª—è —á–∞—Å—Ç—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫

**3. Database Writer**

- Batch insert (1000-10000 –∑–∞–ø–∏—Å–µ–π –∑–∞ —Ä–∞–∑)
- –û—Ç–¥–µ–ª—å–Ω—ã–π thread –¥–ª—è DB –æ–ø–µ—Ä–∞—Ü–∏–π
- Buffering –≤ –ø–∞–º—è—Ç–∏
- Backpressure handling

**4. Memory Management**

- Fixed-size buffers –¥–ª—è –ª–æ–≥–æ–≤/–º–µ—Ç—Ä–∏–∫
- Arena allocator –¥–ª—è packet parsing
- Object pooling –¥–ª—è frequently allocated structures

### Python: Business Logic & API

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```text
FastAPI app initialization
‚îú‚îÄ‚îÄ CORS middleware
‚îú‚îÄ‚îÄ Authentication middleware
‚îú‚îÄ‚îÄ Rate limiting middleware
‚îú‚îÄ‚îÄ Logging middleware
‚îú‚îÄ‚îÄ Router registration
‚îÇ   ‚îú‚îÄ‚îÄ /api/auth
‚îÇ   ‚îú‚îÄ‚îÄ /api/rules
‚îÇ   ‚îú‚îÄ‚îÄ /api/logs
‚îÇ   ‚îú‚îÄ‚îÄ /api/metrics
‚îÇ   ‚îú‚îÄ‚îÄ /api/users
‚îÇ   ‚îú‚îÄ‚îÄ /api/blocked
‚îÇ   ‚îú‚îÄ‚îÄ /api/analytics
‚îÇ   ‚îú‚îÄ‚îÄ /api/settings
‚îÇ   ‚îî‚îÄ‚îÄ /ws/metrics (WebSocket)
‚îú‚îÄ‚îÄ Exception handlers
‚îî‚îÄ‚îÄ Startup/Shutdown events
    ‚îú‚îÄ‚îÄ Database connection pool
    ‚îú‚îÄ‚îÄ Rust core initialization
    ‚îî‚îÄ‚îÄ Background tasks
```

#### Database Session Management

- Connection pooling (SQLAlchemy)
- Session per request pattern
- Automatic commit/rollback
- Read replicas support (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

#### Background Tasks

- Expired blocks cleanup (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç)
- Database vacuum (—Ä–∞–∑ –≤ –¥–µ–Ω—å)
- Backup creation (–ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é)
- Statistics aggregation (–∫–∞–∂–¥—ã–π —á–∞—Å)

### Frontend: React Architecture

#### State Management Strategy

**Zustand stores:**

```text
authStore
‚îú‚îÄ‚îÄ user
‚îú‚îÄ‚îÄ token
‚îú‚îÄ‚îÄ isAuthenticated
‚îî‚îÄ‚îÄ permissions

rulesStore
‚îú‚îÄ‚îÄ rules (cached)
‚îú‚îÄ‚îÄ selectedRule
‚îî‚îÄ‚îÄ filters

settingsStore
‚îú‚îÄ‚îÄ theme (light/dark)
‚îú‚îÄ‚îÄ language
‚îú‚îÄ‚îÄ refreshInterval
‚îî‚îÄ‚îÄ notifications
```

**React Query –¥–ª—è API:**

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π refetch
- Optimistic updates
- Cache invalidation
- Error retry logic

#### Component Hierarchy

**Dashboard**

```text
Dashboard
‚îú‚îÄ‚îÄ MetricsGrid
‚îÇ   ‚îú‚îÄ‚îÄ MetricCard (Total packets)
‚îÇ   ‚îú‚îÄ‚îÄ MetricCard (Accepted)
‚îÇ   ‚îú‚îÄ‚îÄ MetricCard (Dropped)
‚îÇ   ‚îî‚îÄ‚îÄ MetricCard (Active connections)
‚îú‚îÄ‚îÄ TrafficChart (–ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å)
‚îú‚îÄ‚îÄ TopTalkers (top 10 IPs)
‚îú‚îÄ‚îÄ RecentLogs (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 20)
‚îî‚îÄ‚îÄ QuickActions
    ‚îú‚îÄ‚îÄ Block IP button
    ‚îî‚îÄ‚îÄ Add Rule button
```

**Rules Management**

```text
Rules
‚îú‚îÄ‚îÄ RulesToolbar
‚îÇ   ‚îú‚îÄ‚îÄ Search input
‚îÇ   ‚îú‚îÄ‚îÄ Filter dropdowns
‚îÇ   ‚îî‚îÄ‚îÄ Add Rule button
‚îú‚îÄ‚îÄ RulesTable
‚îÇ   ‚îî‚îÄ‚îÄ RuleRow (–¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞)
‚îÇ       ‚îú‚îÄ‚îÄ Rule info
‚îÇ       ‚îú‚îÄ‚îÄ Enable/Disable toggle
‚îÇ       ‚îú‚îÄ‚îÄ Edit button
‚îÇ       ‚îú‚îÄ‚îÄ Delete button
‚îÇ       ‚îî‚îÄ‚îÄ Stats (match_count)
‚îî‚îÄ‚îÄ RuleDialog (modal)
    ‚îî‚îÄ‚îÄ RuleForm
        ‚îú‚îÄ‚îÄ Basic info (name, description)
        ‚îú‚îÄ‚îÄ Source section (IP, country, port)
        ‚îú‚îÄ‚îÄ Destination section
        ‚îú‚îÄ‚îÄ Protocol selector
        ‚îú‚îÄ‚îÄ Action selector
        ‚îî‚îÄ‚îÄ Advanced options (rate limit, logging)
```

**Logs Viewer**

```text
Logs
‚îú‚îÄ‚îÄ LogSearch (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫)
‚îÇ   ‚îú‚îÄ‚îÄ IP input
‚îÇ   ‚îú‚îÄ‚îÄ Action selector
‚îÇ   ‚îú‚îÄ‚îÄ Date range picker
‚îÇ   ‚îú‚îÄ‚îÄ Quick filters (last hour, 24h, 7d)
‚îÇ   ‚îî‚îÄ‚îÄ Search/Reset buttons
‚îú‚îÄ‚îÄ LogTable
‚îÇ   ‚îú‚îÄ‚îÄ Column headers (sortable)
‚îÇ   ‚îú‚îÄ‚îÄ LogRow (–¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏)
‚îÇ   ‚îî‚îÄ‚îÄ Empty state
‚îú‚îÄ‚îÄ Pagination controls
‚îî‚îÄ‚îÄ Export button (CSV/JSON)
```

**Analytics**

```text
Analytics
‚îú‚îÄ‚îÄ SummaryCards
‚îÇ   ‚îú‚îÄ‚îÄ Total packets (24h)
‚îÇ   ‚îú‚îÄ‚îÄ Accepted
‚îÇ   ‚îú‚îÄ‚îÄ Dropped
‚îÇ   ‚îî‚îÄ‚îÄ Total traffic
‚îú‚îÄ‚îÄ ChartsGrid
‚îÇ   ‚îú‚îÄ‚îÄ TrafficOverTime (line chart)
‚îÇ   ‚îú‚îÄ‚îÄ ActionDistribution (pie chart)
‚îÇ   ‚îú‚îÄ‚îÄ TopBlockedIPs (bar chart)
‚îÇ   ‚îú‚îÄ‚îÄ ProtocolDistribution (donut chart)
‚îÇ   ‚îú‚îÄ‚îÄ CountryHeatmap (–æ–ø—Ü.)
‚îÇ   ‚îî‚îÄ‚îÄ HourlyActivity (heatmap)
‚îî‚îÄ‚îÄ TimeRangeSelector (1h, 24h, 7d, 30d, custom)
```

---

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### Database Level

**–ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ:**

- Partial indexes: `CREATE INDEX idx_active_blocks ON blocked_ips(ip_address) WHERE is_active = true`
- Expression indexes: `CREATE INDEX idx_log_hour ON firewall_logs((time::date))`
- BRIN indexes: –¥–ª—è –±–æ–ª—å—à–∏—Ö time-series —Ç–∞–±–ª–∏—Ü (–æ–ø—Ü.)

**Query Optimization:**

- Prepared statements –≤–µ–∑–¥–µ
- EXPLAIN ANALYZE –¥–ª—è –≤—Å–µ—Ö —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ò–∑–±–µ–≥–∞—Ç—å N+1 queries (eager loading)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å COUNT(*) OVER() –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

**TimescaleDB Features:**

- Compression –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö (>7 –¥–Ω–µ–π)
- Continuous aggregates –¥–ª—è dashboard
- Data retention policies
- Chunk size tuning (1 –¥–µ–Ω—å –¥–ª—è logs, 1 —á–∞—Å –¥–ª—è metrics)

### Rust Level

**Memory:**

- Stack allocation –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- Vec capacity pre-allocation
- String interning –¥–ª—è rule names
- Memory-mapped files –¥–ª—è GeoIP DB

**Concurrency:**

- Lock-free structures –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- Read-write locks –≤–º–µ—Å—Ç–æ Mutex
- Channel-based communication –º–µ–∂–¥—É threads
- Work stealing –¥–ª—è parallel processing

**Network:**

- Kernel bypass —á–µ—Ä–µ–∑ AF_PACKET + PACKET_MMAP
- Batch syscalls
- Zero-copy packet processing
- Hardware offloading (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)

### Python Level

**API Performance:**

- Response compression (gzip)
- HTTP/2 support —á–µ—Ä–µ–∑ uvicorn
- Connection pooling
- Query result caching (Redis - –æ–ø—Ü.)

**Database:**

- Connection pooling (min=5, max=20)
- Lazy loading relationships
- Bulk operations –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- Async database driver (asyncpg - –æ–ø—Ü.)

### Frontend Level

**Bundle Size:**

- Code splitting –ø–æ routes
- Lazy loading –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- Tree shaking
- Asset compression

**Runtime:**

- Virtual scrolling –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü
- Debounce –¥–ª—è search inputs
- Memo/useMemo –¥–ª—è expensive calculations
- Web Workers –¥–ª—è heavy processing (–æ–ø—Ü.)

**Network:**

- Request deduplication
- GraphQL batching (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- Service Worker –¥–ª—è offline support (–æ–ø—Ü.)
- CDN –¥–ª—è static assets (production)

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Application Security

**Authentication:**

- JWT —Å –∫–æ—Ä–æ—Ç–∫–∏–º TTL (15 –º–∏–Ω access, 7 –¥–Ω–µ–π refresh)
- Token rotation
- Secure password hashing (bcrypt, rounds=12)
- Rate limiting –Ω–∞ /login (5 –ø–æ–ø—ã—Ç–æ–∫ –∑–∞ 5 –º–∏–Ω—É—Ç)
- Session invalidation –ø—Ä–∏ logout

**Authorization:**

- RBAC –Ω–∞ —É—Ä–æ–≤–Ω–µ API endpoints
- Row-level security –≤ DB (–æ–ø—Ü.)
- Audit –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
- Principle of least privilege

**Input Validation:**

- Pydantic schemas –¥–ª—è –≤—Å–µ—Ö inputs
- IP/CIDR validation
- SQL injection prevention (ORM + prepared statements)
- XSS prevention (React escaping)
- CSRF tokens

**API Security:**

- CORS whitelist
- Rate limiting (100 req/min per IP)
- Request size limits
- Timeout –¥–ª—è long-running requests

### Infrastructure Security

**Database:**

- Encrypted connections (TLS)
- Separate user –¥–ª—è read-only operations
- Regular backups (encrypted)
- No superuser access from app

**Network:**

- Firewall runs on separate VM/interface
- Management interface –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ä—Ç—É
- SSL/TLS –¥–ª—è web interface (Let's Encrypt)
- No direct DB access from internet

**System:**

- Run services as non-root user
- AppArmor/SELinux profiles
- Minimal installed packages
- Regular security updates

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit Tests

**Rust:**

- nftables operations (mocked)
- Pattern matching logic
- Packet parsing
- Database queries (—Å test DB)

**Python:**

- CRUD operations
- Business logic
- Validators
- Utility functions

**Frontend:**

- Component rendering
- User interactions
- Form validation
- API client functions

### Integration Tests

**API Tests:**

- Auth flow (login, refresh, logout)
- CRUD endpoints
- WebSocket connections
- Error handling
- Permission checks

**Database Tests:**

- Complex queries
- Aggregations
- Retention policies
- Backup/restore

### E2E Tests

**Critical User Flows:**

- Login ‚Üí Create rule ‚Üí Verify applied
- View logs ‚Üí Filter ‚Üí Export
- Block IP ‚Üí Verify blocked ‚Üí Unblock
- Dashboard loads ‚Üí Real-time updates work

**Tools:**

- Playwright –¥–ª—è frontend E2E
- pytest –¥–ª—è Python
- cargo test –¥–ª—è Rust

---

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

**Hardware:**

- CPU: 2 cores (4 recommended)
- RAM: 4GB (8GB recommended)
- Disk: 50GB SSD
- Network: 1Gbps interface

**Software:**

- Ubuntu Server 24.04 LTS
- PostgreSQL 15+
- TimescaleDB 2.x
- nftables (kernel 5.x+)
- Python 3.11+
- Rust 1.75+ (–¥–ª—è —Å–±–æ—Ä–∫–∏)
- Node.js 20+ (–¥–ª—è —Å–±–æ—Ä–∫–∏ frontend)

### Production Deployment

**Architecture:**

```text
Internet
   ‚Üì
Nginx (reverse proxy + SSL)
   ‚Üì
FastAPI (Python backend) - systemd service
   ‚Üì
PostgreSQL + TimescaleDB - systemd service
   ‚Üë
Rust Monitor - systemd service (direct DB write)
```

**Systemd Services:**

- `firewall-backend.service` (Python API)
- `firewall-monitor.service` (Rust traffic monitor)
- `postgresql.service` (Database)
- `nginx.service` (Web server)

**Monitoring:**

- systemd logs: `journalctl -u firewall-*`
- Application logs: `/var/log/firewall-manager/`
- Database logs: `/var/log/postgresql/`

---

## –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –°—Ä–æ–∫–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (1 —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫)

| –≠—Ç–∞–ø | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –í—Ä–µ–º—è |
|------|-----------|-------|
| 1 | PostgreSQL schema + TimescaleDB setup | 3-5 –¥–Ω–µ–π |
| 2 | Rust Core (nftables, ipset, bindings) | 2-3 –Ω–µ–¥–µ–ª–∏ |
| 3 | Rust Traffic Monitor (capture, analyze) | 2-3 –Ω–µ–¥–µ–ª–∏ |
| 4 | Rust Database integration (batch inserts) | 1 –Ω–µ–¥–µ–ª—è |
| 5 | Python Backend (API, auth, CRUD) | 2-3 –Ω–µ–¥–µ–ª–∏ |
| 6 | Python-Rust integration | 3-5 –¥–Ω–µ–π |
| 7 | React Frontend (–≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã) | 2-3 –Ω–µ–¥–µ–ª–∏ |
| 8 | WebSocket real-time updates | 3-5 –¥–Ω–µ–π |
| 9 | Analytics —Å—Ç—Ä–∞–Ω–∏—Ü–∞ + —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã | 1 –Ω–µ–¥–µ–ª—è |
| 10 | CLI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | 3-5 –¥–Ω–µ–π |
| 11 | Install/Uninstall scripts | 1 –Ω–µ–¥–µ–ª—è |
| 12 | Systemd services + nginx config | 3-5 –¥–Ω–µ–π |
| 13 | Testing + Bug fixes | 1-2 –Ω–µ–¥–µ–ª–∏ |
| 14 | Documentation | 3-5 –¥–Ω–µ–π |

**–ò—Ç–æ–≥–æ:** 11-15 –Ω–µ–¥–µ–ª—å (2.5-4 –º–µ—Å—è—Ü–∞)

### –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è (–ø–æ—ç—Ç–∞–ø–Ω—ã–π –ø–ª–∞–Ω)

#### Phase 1: Core Infrastructure (3-4 –Ω–µ–¥–µ–ª–∏)

**–¶–µ–ª—å:** –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –±–µ–∑ UI

- PostgreSQL + TimescaleDB setup
  - –°–æ–∑–¥–∞–Ω–∏–µ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ hypertables
  - –ë–∞–∑–æ–≤—ã–µ –∏–Ω–¥–µ–∫—Å—ã
- Rust nftables integration
  - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª
  - –ß—Ç–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –ø—Ä–∞–≤–∏–ª
  - Backup/restore
- Python Backend (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π)
  - Database models (SQLAlchemy)
  - Basic CRUD operations
  - Rust bindings integration
- CLI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç (–±–∞–∑–æ–≤—ã–π)
  - add-rule, delete-rule, list-rules
  - block-ip, unblock-ip

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å firewall —á–µ—Ä–µ–∑ CLI

#### Phase 2: Traffic Monitoring (3-4 –Ω–µ–¥–µ–ª–∏)

**–¶–µ–ª—å:** –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- Rust Traffic Monitor
  - Packet capture (libpcap)
  - Protocol parsing (TCP/UDP/ICMP)
  - Basic pattern matching
- Database integration
  - Batch insert –ª–æ–≥–æ–≤
  - Batch insert –º–µ—Ç—Ä–∏–∫
  - Connection pooling
- Autoblock logic
  - Brute-force detection
  - Port scan detection
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- Python API endpoints
  - GET /api/logs (–ø–æ–∏—Å–∫)
  - GET /api/metrics (–±–∞–∑–æ–≤—ã–µ)
  - GET /api/blocked-ips

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–∏—Å—Ç–µ–º–∞ —Å–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç —É–≥—Ä–æ–∑—ã

#### Phase 3: Web Interface (3-4 –Ω–µ–¥–µ–ª–∏)

**–¶–µ–ª—å:** –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

- Authentication —Å–∏—Å—Ç–µ–º–∞
  - Login/Register
  - JWT tokens
  - Session management
  - Role-based access
- Dashboard —Å—Ç—Ä–∞–Ω–∏—Ü–∞
  - –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (cards)
  - –ü—Ä–æ—Å—Ç—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ (Recharts)
  - Recent logs
- Rules —Å—Ç—Ä–∞–Ω–∏—Ü–∞
  - –°–ø–∏—Å–æ–∫ –ø—Ä–∞–≤–∏–ª (—Ç–∞–±–ª–∏—Ü–∞)
  - –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
  - Enable/disable toggle
  - Delete confirmation
- Blocked IPs —Å—Ç—Ä–∞–Ω–∏—Ü–∞
  - –°–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
  - –†—É—á–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
  - –ü—Ä–∏—á–∏–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- Logs —Å—Ç—Ä–∞–Ω–∏—Ü–∞
  - –¢–∞–±–ª–∏—Ü–∞ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
  - –ë–∞–∑–æ–≤—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã (IP, action)
  - Date range picker

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä

#### Phase 4: Advanced Features (2-3 –Ω–µ–¥–µ–ª–∏)

**–¶–µ–ª—å:** –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- WebSocket integration
  - Real-time –º–µ—Ç—Ä–∏–∫–∏
  - Live log updates
  - Connection status indicator
- Analytics —Å—Ç—Ä–∞–Ω–∏—Ü–∞
  - Top blocked IPs
  - Traffic charts (hourly/daily)
  - Action distribution (pie chart)
  - Country distribution
- Users management (Root only)
  - Approve/reject registrations
  - Role assignment
  - User activity log
- Advanced log search
  - Multiple filters
  - Time range presets
  - Export to CSV/JSON
- Audit log
  - –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - Change tracking

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Production-ready —Å–∏—Å—Ç–µ–º–∞

#### Phase 5: Deployment & Polish (1-2 –Ω–µ–¥–µ–ª–∏)

**–¶–µ–ª—å:** –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

- Install script
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
  - Wizard –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ requirements
- Systemd services
  - Auto-start on boot
  - Graceful shutdown
  - Log rotation
- Nginx configuration
  - Reverse proxy
  - SSL/TLS setup
  - Static files serving
- Backup/Restore
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup
  - Manual backup —á–µ—Ä–µ–∑ CLI
  - Restore mechanism
- Documentation
  - Installation guide
  - User manual
  - API documentation
  - Troubleshooting guide

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ì–æ—Ç–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

---

## Roadmap

### Version 1.1 (Post-MVP)

- GeoIP –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –±–∞–∑
- Threat Intelligence feeds (AbuseIPDB, Shodan)
- Email/SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- Telegram bot –¥–ª—è alerts
- –≠–∫—Å–ø–æ—Ä—Ç –≤ Grafana dashboards

### Version 1.2

- Machine Learning anomaly detection
- DDoS mitigation (L7)
- VPN integration (WireGuard)
- Multi-node support (clustering)
- High Availability mode

### Version 2.0

- IDS/IPS capabilities (Suricata integration)
- Content filtering
- QoS management
- VLAN support
- API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

---

## –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- Rust –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –º–∏–ª–ª–∏–æ–Ω—ã –ø–∞–∫–µ—Ç–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
- TimescaleDB –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è time-series
- Batch inserts –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—é—Ç DB overhead

### ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

- –õ–æ–≥–∏ –∏ –º–µ—Ç—Ä–∏–∫–∏ –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- Retention policies –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ
- Read replicas –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (–æ–ø—Ü.)

### ‚úÖ –£–¥–æ–±—Å—Ç–≤–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

- Python –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
- Rust —Ç–æ–ª—å–∫–æ —Ç–∞–º, –≥–¥–µ –Ω—É–∂–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å
- React –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ UI

### ‚úÖ –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ backup'—ã
- Rollback mechanism
- Audit trail –¥–ª—è –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π

### ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- Defense in depth
- Minimal attack surface
- Regular security updates

---

**–ì–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏! üöÄ**
